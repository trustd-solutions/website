<!DOCTYPE html>
<html lang="en">
  {{ partial "head.html" .}}

  <body>
    {{ partial "header.html" .}}

    <main id="main">
      {{ block "main" . }}
      <!-- The part of the page that begins to differ between templates -->
      {{ end }}
    </main>
    <!-- End #main -->

    <!-- ======= Footer ======= -->
    {{ partial "footer.html" .}}
    <!-- End Footer -->

    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <script>
      function initCarousel(carouselEl, prevEl, nextEl) {
        const slides = carouselEl.querySelectorAll(".slide");
        if (!slides.length) return;

        let currentIndex = 0;

        function getSlidesPerView() {
          if (window.innerWidth <= 768) return 1;
          if (window.innerWidth <= 1024) return 2;
          return 3;
        }

        function updateCarousel() {
          const slideWidth = slides[0].offsetWidth + 20;
          carouselEl.style.transform = `translateX(-${currentIndex * slideWidth}px)`;
        }

        prevEl.addEventListener("click", () => {
          if (currentIndex > 0) {
            currentIndex--;
            updateCarousel();
          }
        });

        nextEl.addEventListener("click", () => {
          const slidesPerView = getSlidesPerView();
          if (currentIndex < slides.length - slidesPerView) {
            currentIndex++;
            updateCarousel();
          }
        });

        updateCarousel();
        window.addEventListener("resize", () => {
          const slidesPerView = getSlidesPerView();
          if (currentIndex > slides.length - slidesPerView) {
            currentIndex = Math.max(0, slides.length - slidesPerView);
          }
          updateCarousel();
        });
      }

      document.querySelectorAll(".carousel-container").forEach((container) => {
        const carousel = container.querySelector(".carousel");
        const prev = container.querySelector(".nav-button:first-child");
        const next = container.querySelector(".nav-button:last-child");
        if (carousel && prev && next) {
          initCarousel(carousel, prev, next);
        }
      });
    </script>

    {{ partial "script.html" .}}
  </body>
</html>
